<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>jiangxunta blog</title>
  <meta name="author" content="jiangxunta">
  
  <meta name="description" content="学习总结 思考感悟 知识管理">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="jiangxunta blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="jiangxunta blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>

<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">jiangxunta blog</a></h1>
  <h2><a href="/">活着即是一场修行</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">归档</a></li>
    
      <li><a href="/js">nodejs</a></li>
    
      <li><a href="/link">前端</a></li>
    
      <li><a href="/work">计划</a></li>
    
      <li><a href="/about">关于</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-29T08:28:30.000Z"><a href="/2016/12/29/react7/">2016-12-29</a></time>
      
      
  
    <h1 class="title"><a href="/2016/12/29/react7/">package.json</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="package-json概述"><a href="#package-json概述" class="headerlink" title="package.json概述"></a>package.json概述</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">每个项目的根目录下面，一般都有一个package.json文件，定义了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等元数据）。 </div><div class="line">package.json文件内部就是一个JSON对象。 </div><div class="line">npm install命令根据这个配置文件，自动下载所需的模块，也就是配置项目所需的运行和开发环境。</div></pre></td></tr></table></figure>
<h3 id="创建package-json"><a href="#创建package-json" class="headerlink" title="创建package.json"></a>创建package.json</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">手动创建 </div><div class="line">npm命令创建</div><div class="line">$ npm init</div><div class="line">一个更完整的package.json文件</div><div class="line">&#123;</div><div class="line">    &quot;name&quot;: &quot;Hello World&quot;,</div><div class="line">    &quot;version&quot;: &quot;0.0.1&quot;,</div><div class="line">    &quot;author&quot;: &quot;张三&quot;,</div><div class="line">    &quot;description&quot;: &quot;第一个node.js程序&quot;,</div><div class="line">    &quot;keywords&quot;:[&quot;node.js&quot;,&quot;javascript&quot;],</div><div class="line">    &quot;repository&quot;: &#123;</div><div class="line">        &quot;type&quot;: &quot;git&quot;,</div><div class="line">        &quot;url&quot;: &quot;https://path/to/url&quot;</div><div class="line">    &#125;,</div><div class="line">    &quot;license&quot;:&quot;MIT&quot;,</div><div class="line">    &quot;engines&quot;: &#123;&quot;node&quot;: &quot;0.10.x&quot;&#125;,</div><div class="line">    &quot;bugs&quot;:&#123;&quot;url&quot;:&quot;http://path/to/bug&quot;,&quot;email&quot;:&quot;bug@example.com&quot;&#125;,</div><div class="line">    &quot;contributors&quot;:[&#123;&quot;name&quot;:&quot;李四&quot;,&quot;email&quot;:&quot;lisi@example.com&quot;&#125;],</div><div class="line">    &quot;scripts&quot;: &#123;</div><div class="line">        &quot;start&quot;: &quot;node index.js&quot;</div><div class="line">    &#125;,</div><div class="line">    &quot;dependencies&quot;: &#123;</div><div class="line">        &quot;express&quot;: &quot;latest&quot;,</div><div class="line">        &quot;mongoose&quot;: &quot;~3.8.3&quot;,</div><div class="line">        &quot;handlebars-runtime&quot;: &quot;~1.0.12&quot;,</div><div class="line">        &quot;express3-handlebars&quot;: &quot;~0.5.0&quot;,</div><div class="line">        &quot;MD5&quot;: &quot;~1.2.0&quot;</div><div class="line">    &#125;,</div><div class="line">    &quot;devDependencies&quot;: &#123;</div><div class="line">        &quot;bower&quot;: &quot;~1.2.8&quot;,</div><div class="line">        &quot;grunt&quot;: &quot;~0.4.1&quot;,</div><div class="line">        &quot;grunt-contrib-concat&quot;: &quot;~0.3.0&quot;,</div><div class="line">        &quot;grunt-contrib-jshint&quot;: &quot;~0.7.2&quot;,</div><div class="line">        &quot;grunt-contrib-uglify&quot;: &quot;~0.2.7&quot;,</div><div class="line">        &quot;grunt-contrib-clean&quot;: &quot;~0.5.0&quot;,</div><div class="line">        &quot;browserify&quot;: &quot;2.36.1&quot;,</div><div class="line">        &quot;grunt-browserify&quot;: &quot;~1.3.0&quot;,</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">下面详细解释package.json文件的各个字段。</div><div class="line"></div><div class="line">4、name </div><div class="line">命名规则: </div><div class="line">1)name必须小于等于214个字节，包括前缀名称在内（如 xxx/xxxmodule）。 </div><div class="line">2)name不能以”_”或”.”开头 </div><div class="line">3)不能含有大写字母 </div><div class="line">4)name会成为url的一部分，不能含有url非法字符</div><div class="line"></div><div class="line">下面是官网文档的一些建议： </div><div class="line">1)不要使用和node核心模块一样的名称 </div><div class="line">2)name中不要含有”js”和”node”。 It’s assumed that it’s js, since you’re writing a package.json file, and you can specify the engine using the “engines” field. (See below.) </div><div class="line">3)name属性会成为模块url、命令行中的一个参数或者一个文件夹名称，任何非url安全的字符在name中都不能使用，也不能以”_”或”.”开头 </div><div class="line">4)name属性也许会被写在require()的参数中，所以最好取个简短而语义化的值。 </div><div class="line">5)创建一个模块前可以先到后边的网址查查name是否已经被占用. https://www.npmjs.com/</div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
    <a href="/2016/12/29/react7/" class="ds-thread-count comment-link alignright" data-thread-key="2016/12/29/react7/" data-count-type="comments"></a>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-29T07:45:42.000Z"><a href="/2016/12/29/react6/">2016-12-29</a></time>
      
      
  
    <h1 class="title"><a href="/2016/12/29/react6/">webpack.config.js参数详解</a></h1>
  

    </header>
    <div class="entry">
      
        <p>webpack.config.js文件通常放在项目的根目录中，它本身也是一个标准的Commonjs规范的模块。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">var webpack = require(&apos;webpack&apos;);</div><div class="line">module.exports = &#123;</div><div class="line">    entry: [</div><div class="line">        &apos;webpack/hot/only-dev-server&apos;,</div><div class="line">        &apos;./js/app.js&apos;</div><div class="line">    ],</div><div class="line">    output: &#123;</div><div class="line">        path: &apos;./build&apos;,</div><div class="line">        filename: &apos;bundle.js&apos;</div><div class="line">    &#125;,</div><div class="line">    module: &#123;</div><div class="line">        loaders: [</div><div class="line">        &#123; test: /\.js?$/, loaders: [&apos;react-hot&apos;, &apos;babel&apos;], exclude:     /node_modules/ &#125;,</div><div class="line">        &#123; test: /\.js$/, exclude: /node_modules/, loader: &apos;babel-loader&apos;&#125;,</div><div class="line">        &#123; test: /\.css$/, loader: &quot;style!css&quot; &#125;,</div><div class="line">        &#123;test: /\.less/,loader: &apos;style-loader!css-loader!less-loader&apos;&#125;</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    resolve:&#123;</div><div class="line">        extensions:[&apos;&apos;,&apos;.js&apos;,&apos;.json&apos;]</div><div class="line">    &#125;,</div><div class="line">    plugins: [</div><div class="line">        new webpack.NoErrorsPlugin()</div><div class="line">    ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="entry"><a href="#entry" class="headerlink" title="entry"></a>entry</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">entry可以是个字符串或数组或者是对象。 </div><div class="line">当entry是个字符串的时候，用来定义入口文件：</div><div class="line">entry: &apos;./js/main.js&apos;</div><div class="line">当entry是个数组的时候，里面同样包含入口js文件，另外一个参数可以是用来配置webpack提供的一个静态资源服务器，webpack-dev-server。webpack-dev-server会监控项目中每一个文件的变化，实时的进行构建，并且自动刷新页面：</div><div class="line"></div><div class="line">entry: [</div><div class="line">    &apos;webpack/hot/only-dev-server&apos;,</div><div class="line">    &apos;./js/app.js&apos;</div><div class="line">]</div><div class="line">当entry是个对象的时候，我们可以将不同的文件构建成不同的文件，按需使用，比如在我的hello页面中只要\引入hello.js即可：</div><div class="line">entry: &#123;</div><div class="line">    hello: &apos;./js/hello.js&apos;,</div><div class="line">    form: &apos;./js/form.js&apos;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h3 id="output"><a href="#output" class="headerlink" title="output"></a>output</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">output参数是个对象，用于定义构建后的文件的输出。其中包含path和filename：</div><div class="line">output: &#123;</div><div class="line">    path: &apos;./build&apos;,</div><div class="line">    filename: &apos;bundle.js&apos;</div><div class="line">&#125;</div><div class="line">当我们在entry中定义构建多个文件时，filename可以对应的更改为[name].js用于定义不同文件构建后的名字。</div></pre></td></tr></table></figure>
<h3 id="module"><a href="#module" class="headerlink" title="module"></a>module</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">关于模块的加载相关，我们就定义在module.loaders中。这里通过正则表达式去匹配不同后缀的文件名，然后给它们定义不同的加载器。比如说给less文件定义串联的三个加载器（！用来定义级联关系）：</div><div class="line">module: &#123;</div><div class="line">    loaders: [</div><div class="line">        &#123; test: /\.js?$/, loaders: [&apos;react-hot&apos;, &apos;babel&apos;], exclude: /node_modules/ &#125;,</div><div class="line">        &#123; test: /\.js$/, exclude: /node_modules/, loader: &apos;babel-loader&apos;&#125;,</div><div class="line">        &#123; test: /\.css$/, loader: &quot;style!css&quot; &#125;,</div><div class="line">        &#123; test: /\.less/, loader: &apos;style-loader!css-loader!less-loader&apos;&#125;</div><div class="line">    ]</div><div class="line">&#125;</div><div class="line">此外，还可以添加用来定义png、jpg这样的图片资源在小于10k时自动处理为base64图片的加载器：</div><div class="line">&#123; test: /\.(png|jpg)$/,loader: &apos;url-loader?limit=10000&apos;&#125;</div><div class="line">给css和less还有图片添加了loader之后，我们不仅可以像在node中那样require js文件了，我们还可以require css、less甚至图片文件：</div><div class="line">require(&apos;./bootstrap.css&apos;);</div><div class="line">require(&apos;./myapp.less&apos;);</div><div class="line">var img = document.createElement(&apos;img&apos;);</div><div class="line">img.src = require(&apos;./glyph.png&apos;);</div><div class="line">但是需要知道的是，这样require来的文件会内联到 js bundle中。如果我们需要把保留require的写法又想把css文件单独拿出来，可以使用下面提到的[extract-text-webpack-plugin]插件。 </div><div class="line">在上面示例代码中配置的第一个loaders我们可以看到一个叫做React-hot的加载器。我的项目是用来学习react写相关代码的，所以配置了一个react-hot加载器，通过它，可以实现对react组件的热替换。我们已经在entry参数中配置了webpack/hot/only-dev-server,所以我们只要在启动webpack开发服务器时开启–hot参数，就可以使用react-hot-loader了。在package.json文件中这样定义：</div><div class="line">&quot;scripts&quot;: &#123;</div><div class="line">     &quot;start&quot;: &quot;webpack-dev-server --hot --progress --colors&quot;,</div><div class="line">     &quot;build&quot;: &quot;webpack --progress --colors&quot;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h3 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">webpack在构建包的时候会按目录的进行文件的查找，resolve属性中的extensions数组中用于配置程序可以自行补全哪些文件后缀：</div><div class="line">resolve:&#123;</div><div class="line">    extensions:[&apos;&apos;,&apos;.js&apos;,&apos;.json&apos;]</div><div class="line">&#125;</div><div class="line">然后我们想要加载一个js文件时，只要require(‘common’)就可以加载common.js文件了。</div></pre></td></tr></table></figure>
<h3 id="externals"><a href="#externals" class="headerlink" title="externals"></a>externals</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">当我们想在项目中require一些其他的类库或者API，而又不想让这些类库的源码被构建到运行时文件中，这在实际开发中很有必要。此时我们就可以通过配置externals参数来解决这个问题：</div><div class="line">externals: &#123;</div><div class="line">    &quot;jquery&quot;: &quot;jQuery&quot;</div><div class="line">&#125;</div><div class="line">这样我们就可以放心的在项目中使用这些API了：var jQuery = require(“jquery”);</div></pre></td></tr></table></figure>
<h3 id="context"><a href="#context" class="headerlink" title="context"></a>context</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">当我们在require一个模块的时候，如果在require中包含变量，像这样：</div><div class="line">require(&quot;./mods/&quot; + name + &quot;.js&quot;);</div><div class="line">那么在编译的时候我们是不能知道具体的模块的。但这个时候，webpack也会为我们做些分析工作：</div><div class="line">1.分析目录：’./mods’； </div><div class="line">2.提取正则表达式：’/^.*.js$/’；</div><div class="line"></div><div class="line">于是这个时候为了更好地配合wenpack进行编译，我们可以给它指明路径，像在cake-webpack-config中所做的那样（我们在这里先忽略abcoption的作用）：</div><div class="line">var currentBase = process.cwd();</div><div class="line">var context = abcOptions.options.context ? abcOptions.options.context : </div><div class="line">path.isAbsolute(entryDir) ? entryDir : path.join(currentBase, entryDir);</div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
    <a href="/2016/12/29/react6/" class="ds-thread-count comment-link alignright" data-thread-key="2016/12/29/react6/" data-count-type="comments"></a>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-29T07:42:43.000Z"><a href="/2016/12/29/react5/">2016-12-29</a></time>
      
      
  
    <h1 class="title"><a href="/2016/12/29/react5/">node path 对象</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="NodeJS中的Path对象，用于处理目录的对象，提高开发效率。"><a href="#NodeJS中的Path对象，用于处理目录的对象，提高开发效率。" class="headerlink" title="NodeJS中的Path对象，用于处理目录的对象，提高开发效率。"></a>NodeJS中的Path对象，用于处理目录的对象，提高开发效率。</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">引入path对象</div><div class="line">var path = require(&apos;path&apos;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">格式化路径 </div><div class="line">path.normalize(p) </div><div class="line">将不符合规范的路径格式化，简化开发人员中处理各种复杂的路径判断</div><div class="line">path.normalize(&apos;/foo/bar//baz/asdf/quux/..&apos;);  </div><div class="line">// returns   </div><div class="line">&apos;/foo/bar/baz/asdf&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">路径联合 </div><div class="line">path.join([path1], [path2], […]) </div><div class="line">将所有名称用path.seq串联起来，然后用normailze格式化</div><div class="line"></div><div class="line">path.join(&apos;///foo&apos;, &apos;bar&apos;, &apos;//baz/asdf&apos;, &apos;quux&apos;, &apos;..&apos;);  </div><div class="line">// returns   </div><div class="line">&apos;/foo/bar/baz/asdf&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">路径寻航 </div><div class="line">path.resolve([from …], to) </div><div class="line">相当于不断的调用系统的cd命令</div><div class="line"></div><div class="line">path.resolve(&apos;foo/bar&apos;, &apos;/tmp/file/&apos;, &apos;..&apos;, &apos;a/../subfile&apos;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">相对路径 </div><div class="line">path.relative(from, to) </div><div class="line">返回某个路径下相对于另一个路径的相对位置串，相当于：path.resolve(from, path.relative(from, to)) == path.resolve(to)</div><div class="line"></div><div class="line">path.relative(&apos;C:\\orandea\\test\\aaa&apos;, &apos;C:\\orandea\\impl\\bbb&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;..\\..\\impl\\bbb&apos;  </div><div class="line"></div><div class="line">path.relative(&apos;/data/orandea/test/aaa&apos;, &apos;/data/orandea/impl/bbb&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;../../impl/bbb&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">文件夹名称 </div><div class="line">path.dirname(p) </div><div class="line">返回路径的所在的文件夹名称</div><div class="line"></div><div class="line">path.dirname(&apos;/foo/bar/baz/asdf/quux&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;/foo/bar/baz/asdf&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">文件名称 </div><div class="line">path.basename(p, [ext]) </div><div class="line">返回指定的文件名，返回结果可排除[ext]后缀字符串</div><div class="line"></div><div class="line">path.basename(&apos;/foo/bar/baz/asdf/quux.html&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;quux.html&apos;  </div><div class="line"></div><div class="line">path.basename(&apos;/foo/bar/baz/asdf/quux.html&apos;, &apos;.html&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;quux&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">扩展名称 </div><div class="line">path.extname(p) </div><div class="line">返回指定文件名的扩展名称</div><div class="line"></div><div class="line">path.extname(&apos;index.html&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;.html&apos;  </div><div class="line"></div><div class="line">path.extname(&apos;index.&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;.&apos;  </div><div class="line"></div><div class="line">path.extname(&apos;index&apos;)  </div><div class="line">// returns  </div><div class="line">&apos;&apos;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">路径分隔符 </div><div class="line">path.sep </div><div class="line">获取文件路径的分隔符，主要是与操作系统相关 </div><div class="line">window:</div><div class="line"></div><div class="line">&apos;foo\\bar\\baz&apos;.split(path.sep)  </div><div class="line">// returns  </div><div class="line">[&apos;foo&apos;, &apos;bar&apos;, &apos;baz&apos;] </div><div class="line">Linux:</div><div class="line"></div><div class="line">&apos;foo/bar/baz&apos;.split(path.sep)  </div><div class="line">// returns  </div><div class="line">[&apos;foo&apos;, &apos;bar&apos;, &apos;baz&apos;]</div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
    <a href="/2016/12/29/react5/" class="ds-thread-count comment-link alignright" data-thread-key="2016/12/29/react5/" data-count-type="comments"></a>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-28T04:15:31.000Z"><a href="/2016/12/28/react4/">2016-12-28</a></time>
      
      
  
    <h1 class="title"><a href="/2016/12/28/react4/">react4</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="DOM和事件的处理"><a href="#DOM和事件的处理" class="headerlink" title="DOM和事件的处理"></a>DOM和事件的处理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">给元素加上ref=&quot;xxx&quot;后，可直接通过this.refs.xxx获取该DOM元素，而不需要使用getDOMNode/findDOMNode。</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">var converter = new showdown.Converter();</div><div class="line"></div><div class="line">var MarkdownEditor = React.createClass(&#123;</div><div class="line">  getInitialState: function() &#123;</div><div class="line">    return &#123;value: &apos;# 我是一级大标题&apos;&#125;;</div><div class="line">  &#125;,</div><div class="line">  handleChange: function() &#123;</div><div class="line">    this.setState(&#123;value: this.refs.textarea.value&#125;);</div><div class="line">  &#125;,</div><div class="line">  conponentDidMount: function()&#123;</div><div class="line">    console.log(this.refs.textarea);</div><div class="line">  &#125;,</div><div class="line">  conponentWillMount: function()&#123;</div><div class="line">    // dangerouslySetInnerHTML这种功能主要用来与 DOM 字符串操作类库一起使用，</div><div class="line">    // 所以提供的 HTML 必须要格式清晰</div><div class="line">    // console.log(converter.makeHtml(this.state.value));</div><div class="line">  &#125;,</div><div class="line">  render: function() &#123;</div><div class="line">    return (</div><div class="line">      &lt;div className=&quot;MarkdownEditor&quot;&gt;</div><div class="line">        &lt;h3&gt;输入&lt;/h3&gt;</div><div class="line">        &lt;textarea</div><div class="line">          onChange=&#123;this.handleChange&#125;</div><div class="line">          ref=&quot;textarea&quot;</div><div class="line">          defaultValue=&#123;this.state.value&#125; /&gt;</div><div class="line">        &lt;h3&gt;输出&lt;/h3&gt;</div><div class="line">        &lt;div</div><div class="line">          className=&quot;content&quot;</div><div class="line">          dangerouslySetInnerHTML=&#123;&#123;</div><div class="line">            __html: converter.makeHtml(this.state.value)</div><div class="line">          &#125;&#125;</div><div class="line">        /&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  &lt;MarkdownEditor /&gt;,</div><div class="line">  document.getElementById(&apos;example&apos;)</div><div class="line">);</div></pre></td></tr></table></figure>
<h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">虚拟事件对象： 事件处理器将会传入虚拟事件对象的实例，一个对浏览器本地事件的跨浏览器封装。它有和浏览器本地事件相同的属性和方法，包括 stopPropagation() 和 preventDefault()，但是没有浏览器兼容问题。</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">支持的事件</div><div class="line">剪贴板事件</div><div class="line">onCopy onCut onPaste</div><div class="line">键盘事件：</div><div class="line">onKeyDown onKeyPress onKeyUp</div><div class="line">焦点事件</div><div class="line">onFocus onBlur</div><div class="line">表单事件</div><div class="line">onChange onInput onSubmit</div><div class="line">鼠标事件</div><div class="line">onClick onDoubleClick onDrag onDragEnd onDragEnter onDragExit onDragLeave</div><div class="line">onDragOver onDragStart onDrop onMouseDown onMouseEnter onMouseLeave</div><div class="line">onMouseMove onMouseOut onMouseOver onMouseUp</div><div class="line">触摸事件</div><div class="line">为了使触摸事件生效，在渲染所有组件之前调用 React.initializeTouchEvents(true)。</div><div class="line"></div><div class="line">onTouchCancel onTouchEnd onTouchMove onTouchStart</div><div class="line">UI 事件</div><div class="line">onScroll</div><div class="line">鼠标滚轮滚动事件</div><div class="line">onWheel</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line">表单事件处理</div><div class="line">// 该表单组件里面用到了RadioButtons和Checkboxes</div><div class="line">var FormApp = React.createClass(&#123;</div><div class="line">    getInitialState:function()&#123;</div><div class="line">        return &#123;</div><div class="line">            inputValue: &apos;请输入...&apos;,</div><div class="line">            selectValue: &apos;A&apos;,</div><div class="line">            radioValue:&apos;B&apos;,</div><div class="line">            checkValues:[],</div><div class="line">            textareaValue:&apos;请输入...&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    handleSubmit:function(e)&#123;</div><div class="line">        e.preventDefault();</div><div class="line">        var formData = &#123;</div><div class="line">            input: this.refs.goodInput.getDOMNode().value,</div><div class="line">            select: this.refs.goodSelect.getDOMNode().value,</div><div class="line">            textarea: this.refs.goodTextarea.getDOMNode().value,</div><div class="line">            radio: this.state.radioValue,</div><div class="line">            check: this.state.checkValues,</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        console.log(&apos;the form result is:&apos;)</div><div class="line">        console.log(formData);</div><div class="line"></div><div class="line">        this.refs.goodRadio.saySomething();</div><div class="line"></div><div class="line">    &#125;,</div><div class="line">    handleRadio:function(e)&#123;</div><div class="line">        this.setState(&#123;</div><div class="line">            radioValue: e.target.value,</div><div class="line">        &#125;)</div><div class="line">    &#125;,</div><div class="line">    handleCheck:function(e)&#123;</div><div class="line">        var checkValues = this.state.checkValues.slice();</div><div class="line">        var newVal = e.target.value;</div><div class="line">        var index = checkValues.indexOf(newVal);</div><div class="line">        if( index == -1 )&#123;</div><div class="line">            checkValues.push( newVal )</div><div class="line">        &#125;else&#123;</div><div class="line">            checkValues.splice(index,1);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        this.setState(&#123;</div><div class="line">            checkValues: checkValues,</div><div class="line">        &#125;)</div><div class="line">    &#125;,</div><div class="line">    render: function()&#123;</div><div class="line">        return (</div><div class="line">            &lt;form onSubmit=&#123;this.handleSubmit&#125;&gt;</div><div class="line">                &lt;input ref=&quot;goodInput&quot; type=&quot;text&quot; defaultValue=&#123;this.state.inputValue &#125;/&gt;</div><div class="line">                &lt;br/&gt;</div><div class="line">                选项：</div><div class="line">                &lt;select defaultValue=&#123; this.state.selectValue &#125; ref=&quot;goodSelect&quot;&gt;</div><div class="line">                    &lt;option value=&quot;A&quot;&gt;A&lt;/option&gt;</div><div class="line">                    &lt;option value=&quot;B&quot;&gt;B&lt;/option&gt;</div><div class="line">                    &lt;option value=&quot;C&quot;&gt;C&lt;/option&gt;</div><div class="line">                    &lt;option value=&quot;D&quot;&gt;D&lt;/option&gt;</div><div class="line">                    &lt;option value=&quot;E&quot;&gt;E&lt;/option&gt;</div><div class="line">                &lt;/select&gt;</div><div class="line">                &lt;br/&gt;</div><div class="line">                &lt;p&gt;radio button!&lt;/p&gt;</div><div class="line">                &lt;RadioButtons ref=&quot;goodRadio&quot; handleRadio=&#123;this.handleRadio&#125; /&gt;</div><div class="line">                &lt;br/&gt;</div><div class="line"></div><div class="line">                &lt;Checkboxes handleCheck=&#123;this.handleCheck&#125; /&gt;</div><div class="line">                &lt;br/&gt;</div><div class="line">                &lt;textarea defaultValue=&#123;this.state.textareaValue&#125; ref=&quot;goodTextarea&quot;&gt;&lt;/textarea&gt;</div><div class="line">                &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;</div><div class="line"></div><div class="line">            &lt;/form&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 定义单选框按钮组</div><div class="line">var RadioButtons = React.createClass(&#123;</div><div class="line">    saySomething:function()&#123;</div><div class="line">        alert(&quot;yo what&apos;s up man!&quot;);</div><div class="line">    &#125;,</div><div class="line">    render:function()&#123;</div><div class="line">        return (</div><div class="line">            &lt;span&gt;</div><div class="line">                A</div><div class="line">                &lt;input onChange=&#123;this.props.handleRadio&#125; name=&quot;goodRadio&quot; type=&quot;radio&quot; value=&quot;A&quot;/&gt;</div><div class="line">                B</div><div class="line">                &lt;input onChange=&#123;this.props.handleRadio&#125; name=&quot;goodRadio&quot; type=&quot;radio&quot; defaultChecked value=&quot;B&quot;/&gt;</div><div class="line">                C</div><div class="line">                &lt;input onChange=&#123;this.props.handleRadio&#125; name=&quot;goodRadio&quot; type=&quot;radio&quot; value=&quot;C&quot;/&gt;</div><div class="line">            &lt;/span&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">var Checkboxes = React.createClass(&#123;</div><div class="line">    render: function()&#123;</div><div class="line">        return (</div><div class="line">            &lt;span&gt;</div><div class="line">                A</div><div class="line">                &lt;input onChange=&#123;this.props.handleCheck&#125;  name=&quot;goodCheckbox&quot; type=&quot;checkbox&quot; value=&quot;A&quot;/&gt;</div><div class="line">                B</div><div class="line">                &lt;input onChange=&#123;this.props.handleCheck&#125; name=&quot;goodCheckbox&quot; type=&quot;checkbox&quot; value=&quot;B&quot; /&gt;</div><div class="line">                C</div><div class="line">                &lt;input onChange=&#123;this.props.handleCheck&#125; name=&quot;goodCheckbox&quot; type=&quot;checkbox&quot; value=&quot;C&quot; /&gt;</div><div class="line">            &lt;/span&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line">ReactDOM.render(&lt;FormApp /&gt;, document.getElementById(&apos;app&apos;));</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div></pre></td><td class="code"><pre><div class="line">一个综合示例</div><div class="line">结合以上知识点，来看一个基于React、jquery和bootstrap完成的一个简单的组件。</div><div class="line"></div><div class="line">// 定义一个按钮组件</div><div class="line">var BootstrapButton = React.createClass(&#123;</div><div class="line">  render: function() &#123;</div><div class="line">    return (</div><div class="line">      &lt;a &#123;...this.props&#125;</div><div class="line">        href=&quot;javascript:;&quot;</div><div class="line">        role=&quot;button&quot;</div><div class="line">        className=&#123;(this.props.className || &apos;&apos;) + &apos; btn&apos;&#125; /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">// 定义一个弹框组件</div><div class="line">var BootstrapModal = React.createClass(&#123;</div><div class="line">  // 节点插入到真实的DOM，使用jquery</div><div class="line">  componentDidMount: function() &#123;</div><div class="line">    // 调用bootstrap插件</div><div class="line">    $(this.refs.root).modal(&#123;backdrop: &apos;static&apos;, keyboard: false, show: false&#125;);</div><div class="line">  &#125;,</div><div class="line">  // 在组件销毁的时候，记得把之前绑定的方法给干掉</div><div class="line">  componentWillUnmount: function() &#123;</div><div class="line">    $(this.refs.root).off(&apos;hidden&apos;, this.handleHidden);</div><div class="line">  &#125;,</div><div class="line">  close: function() &#123;</div><div class="line">    $(this.refs.root).modal(&apos;hide&apos;);</div><div class="line">  &#125;,</div><div class="line">  open: function() &#123;</div><div class="line">    $(this.refs.root).modal(&apos;show&apos;);</div><div class="line">  &#125;,</div><div class="line">  render: function() &#123;</div><div class="line">    var confirmButton = null;</div><div class="line">    var cancelButton = null;</div><div class="line"></div><div class="line">    if (this.props.confirm) &#123;</div><div class="line">      confirmButton = (</div><div class="line">        &lt;BootstrapButton</div><div class="line">          onClick=&#123;this.handleConfirm&#125;</div><div class="line">          className=&quot;btn-primary&quot;&gt;</div><div class="line">          &#123;this.props.confirm&#125;</div><div class="line">        &lt;/BootstrapButton&gt;</div><div class="line">      );</div><div class="line">    &#125;</div><div class="line">    if (this.props.cancel) &#123;</div><div class="line">      cancelButton = (</div><div class="line">        &lt;BootstrapButton onClick=&#123;this.handleCancel&#125; className=&quot;btn-default&quot;&gt;</div><div class="line">          &#123;this.props.cancel&#125;</div><div class="line">        &lt;/BootstrapButton&gt;</div><div class="line">      );</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return (</div><div class="line">      &lt;div className=&quot;modal fade&quot; ref=&quot;root&quot;&gt;</div><div class="line">        &lt;div className=&quot;modal-dialog&quot;&gt;</div><div class="line">          &lt;div className=&quot;modal-content&quot;&gt;</div><div class="line">            &lt;div className=&quot;modal-header&quot;&gt;</div><div class="line">              &lt;button</div><div class="line">                type=&quot;button&quot;</div><div class="line">                className=&quot;close&quot;</div><div class="line">                onClick=&#123;this.handleCancel&#125;&gt;</div><div class="line">                &amp;times;</div><div class="line">              &lt;/button&gt;</div><div class="line">              &lt;h3&gt;&#123;this.props.title&#125;&lt;/h3&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div className=&quot;modal-body&quot;&gt;</div><div class="line">              &#123;this.props.children&#125;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div className=&quot;modal-footer&quot;&gt;</div><div class="line">              &#123;cancelButton&#125;</div><div class="line">              &#123;confirmButton&#125;</div><div class="line">            &lt;/div&gt;</div><div class="line">          &lt;/div&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line">  handleCancel: function() &#123;</div><div class="line">    if (this.props.onCancel) &#123;</div><div class="line">      this.props.onCancel();</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  handleConfirm: function() &#123;</div><div class="line">    if (this.props.onConfirm) &#123;</div><div class="line">      this.props.onConfirm();</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 调用刚才咱们定义的两个组件，写咱们的业务组件</div><div class="line">var Example = React.createClass(&#123;</div><div class="line">  handleCancel: function() &#123;</div><div class="line">    if (confirm(&apos;亲，确定要取消么&apos;)) &#123;</div><div class="line">      this.refs.modal.close();</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  render: function() &#123;</div><div class="line">    var modal = null;</div><div class="line">    modal = (</div><div class="line">      &lt;BootstrapModal</div><div class="line">        ref=&quot;modal&quot;</div><div class="line">        confirm=&quot;OK&quot;</div><div class="line">        cancel=&quot;Cancel&quot;</div><div class="line">        onCancel=&#123;this.handleCancel&#125;</div><div class="line">        onConfirm=&#123;this.closeModal&#125;</div><div class="line">        title=&quot;Hello, Bootstrap!&quot;&gt;</div><div class="line">          这是一个结合jQuery和Bootstrap而写的组件</div><div class="line">      &lt;/BootstrapModal&gt;</div><div class="line">    );</div><div class="line">    return (</div><div class="line">      &lt;div className=&quot;example&quot;&gt;</div><div class="line">        &#123;modal&#125;</div><div class="line">        &lt;BootstrapButton onClick=&#123;this.openModal&#125; className=&quot;btn-default&quot;&gt;</div><div class="line">          Open modal</div><div class="line">        &lt;/BootstrapButton&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line">  openModal: function() &#123;</div><div class="line">    this.refs.modal.open();</div><div class="line">  &#125;,</div><div class="line">  closeModal: function() &#123;</div><div class="line">    this.refs.modal.close();</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">ReactDOM.render(&lt;Example /&gt;, document.getElementById(&apos;example&apos;));</div></pre></td></tr></table></figure>
<h3 id="mixin"><a href="#mixin" class="headerlink" title="mixin"></a>mixin</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line">什么是mixin</div><div class="line">mixin是解决代码重复的强大工具之一，它同时还能让组件保持专注于自身的业务逻辑。实际运用中的简单理解就是：她们就是混合进组建类的对象而已。（讲人话：让不同的组件共用同一部分逻辑，实现代码重用）</div><div class="line"></div><div class="line">示例</div><div class="line">// 组件间都需要用到的一段逻辑</div><div class="line">// 经常写太麻烦，抽离出来公用</div><div class="line">var stateRecordMixin = &#123;</div><div class="line">    componentWillMount:function()&#123;</div><div class="line">        this.oldStates = [];</div><div class="line">    &#125;,</div><div class="line">    componentWillUpdate: function(nextProp,nextState)&#123;</div><div class="line">        this.oldStates.push(nextState);</div><div class="line">    &#125;,</div><div class="line">    previousState:function()&#123;</div><div class="line">        var index = this.oldStates.length -1;</div><div class="line">        return index == -1 ? &#123;&#125; : this.oldStates[index];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 定义一个组件MessageBox</div><div class="line">var MessageBox = React.createClass(&#123;</div><div class="line">  // 在这里使用mixin</div><div class="line">    mixins: [stateRecordMixin],</div><div class="line">    getInitialState:function()&#123;</div><div class="line">        return &#123;</div><div class="line">            count: 0,</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    doUpdate:function()&#123;</div><div class="line">        this.setState(&#123;</div><div class="line">            count: this.state.count + 1,</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        alert(&apos;上一次的计数是：&apos;+this.previousState().count)</div><div class="line">    &#125;,</div><div class="line">    render:function()&#123;</div><div class="line">        console.log(&apos;渲染&apos;);</div><div class="line">        return (</div><div class="line">            &lt;div&gt;</div><div class="line">                &lt;h1 &gt; 计数： &#123;this.state.count&#125;&lt;/h1&gt;</div><div class="line">                &lt;button onClick=&#123;this.doUpdate&#125;&gt;手动更新一下组件（包括子组件）&lt;/button&gt;</div><div class="line">                &lt;Submessage count=&#123;this.state.count&#125;/&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">var Submessage = React.createClass(&#123;</div><div class="line">    mixins: [stateRecordMixin],</div><div class="line">    getInitialState:function()&#123;</div><div class="line">        return &#123;</div><div class="line">            count: 0,</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    componentWillReceiveProps:function(nextProp)&#123;</div><div class="line">        this.setState(&#123;</div><div class="line">            count: this.props.count *2,</div><div class="line">        &#125;)</div><div class="line">    &#125;,</div><div class="line">    render:function()&#123;</div><div class="line">        console.log(&apos;上一次子组件的计数是：&apos;+this.previousState().count )</div><div class="line">        return (</div><div class="line">            &lt;h3&gt;当前子组件的计数是：&#123;this.state.count&#125;&lt;/h3&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 使用组件</div><div class="line">ReactDOM.render( &lt;MessageBox/&gt;,</div><div class="line">    document.getElementById(&apos;app&apos;)</div><div class="line">)</div></pre></td></tr></table></figure>
<p><a href="https://facebook.github.io/react/" target="_blank" rel="external">facebook.github.io</a><br><a href="http://react-china.org/" target="_blank" rel="external">react-china</a><br><a href="http://reactjs.cn/" target="_blank" rel="external">http://reactjs.cn/</a><br><a href="https://github.com/facebook/react" target="_blank" rel="external">github</a><br><a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="external">ruanyifeng</a><br><a href="https://github.com/zexeo" target="_blank" rel="external">zexeo</a></p>

      
    </div>
    <footer>
      
        
        
    <a href="/2016/12/28/react4/" class="ds-thread-count comment-link alignright" data-thread-key="2016/12/28/react4/" data-count-type="comments"></a>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-28T04:02:59.000Z"><a href="/2016/12/28/react3/">2016-12-28</a></time>
      
      
  
    <h1 class="title"><a href="/2016/12/28/react3/">react3</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="react组件的生命周期"><a href="#react组件的生命周期" class="headerlink" title="react组件的生命周期"></a>react组件的生命周期</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line">React为每个组件都提供了简洁的生命周期API，去响应组件在不同阶段（创建时，存在时，销毁时）执行相应的操作，更精确的管理每一个组件。</div><div class="line">钩子函数</div><div class="line">什么是钩子函数，可以理解为在组件生命周期中某个确定的时间点执行的函数。以下是对钩子函数的总结：</div><div class="line">实例化（渲染前）</div><div class="line">getDefaultProps() 生命周期中只会执行一次</div><div class="line">getInitialState()</div><div class="line">componentWillmount()</div><div class="line">render()</div><div class="line">这意味着你可以在这个组件插入到DOM之前都可以调用这些API</div><div class="line">组件存在期（渲染为真实的DOM）</div><div class="line">componentDidMount()</div><div class="line">shouldComponentUpdate()</div><div class="line">componentWillUpdate()</div><div class="line">componentWillUnmount()</div><div class="line">销毁期</div><div class="line">componentDidUnmount()</div><div class="line"></div><div class="line">实例</div><div class="line">var MessageBox = React.createClass(&#123;</div><div class="line">  getInitialState:function()&#123;</div><div class="line">    return &#123;</div><div class="line">        count: 0,</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  getDefaultProps:function()&#123;</div><div class="line">    console.log(&apos;getDefaultProps&apos;);</div><div class="line">  &#125;,</div><div class="line">  componentWillMount:function()&#123;</div><div class="line">    console.log(&apos;componentWillMount&apos;);</div><div class="line">  &#125;,</div><div class="line">  componentDidMount:function()&#123;</div><div class="line">    console.log(&apos;componentDidMount&apos;);</div><div class="line">  &#125;,</div><div class="line">  componentWillUnmount: function()&#123;</div><div class="line">    console.log(&apos;componentWillUnmount&apos;);</div><div class="line">  &#125;,</div><div class="line">  shouldComponentUpdate:function(nextProp,nextState)&#123;</div><div class="line">    console.log(&apos;shouldComponentUpdate&apos;);</div><div class="line">    if(nextState.count &gt; 10) return false;</div><div class="line"></div><div class="line">    return true;</div><div class="line">  &#125;,</div><div class="line">  componentWillUpdate:function(nextProp,nextState)&#123;</div><div class="line">    console.log(&apos;componentWillUpdate&apos;);</div><div class="line">  &#125;,</div><div class="line">  componentDidUpdate:function()&#123;</div><div class="line">    console.log(&apos;componentDidUpdate&apos;);</div><div class="line">  &#125;,</div><div class="line">  killMySelf: function()&#123;</div><div class="line">      // 包括顶级容器一块干掉，当然在实际项目中可别干这样的傻事</div><div class="line">      React.unmountComponentAtNode(  document.getElementById(&apos;app&apos;) );</div><div class="line">  &#125;,</div><div class="line">  doUpdate:function()&#123;</div><div class="line">    this.setState(&#123;</div><div class="line">        count: this.state.count + 1,</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line">  render:function()&#123;</div><div class="line">    console.log(&apos;渲染&apos;)</div><div class="line">    return (</div><div class="line">        &lt;div&gt;</div><div class="line">            &lt;h1 &gt; 计数： &#123;this.state.count&#125;&lt;/h1&gt;</div><div class="line">            &lt;button onClick=&#123;this.killMySelf&#125;&gt;卸载掉这个组件&lt;/button&gt;</div><div class="line">            &lt;button onClick=&#123;this.doUpdate&#125;&gt;手动更新一下组件（包括子组件）&lt;/button&gt;</div><div class="line">            &lt;Submessage count=&#123;this.state.count&#125;/&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">var Submessage = React.createClass(&#123;</div><div class="line">  componentWillReceiveProps:function(nextProp)&#123;</div><div class="line">      console.log(&apos;子组件将要获得prop&apos;);</div><div class="line">  &#125;,</div><div class="line">  shouldComponentUpdate:function(nextProp,nextState)&#123;</div><div class="line">      if(nextProp.count&gt; 5) return false;</div><div class="line">      return true;</div><div class="line">  &#125;,</div><div class="line">  render:function()&#123;</div><div class="line">      return (</div><div class="line">          &lt;h3&gt;当前计数是：&#123;this.props.count&#125;&lt;/h3&gt;</div><div class="line">      )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">ReactDOM.render( &lt;MessageBox/&gt;, document.getElementById(&apos;app&apos;) );</div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
    <a href="/2016/12/28/react3/" class="ds-thread-count comment-link alignright" data-thread-key="2016/12/28/react3/" data-count-type="comments"></a>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>






<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <SCRIPT language=javascript>
function search(formname) {
    formname.method = "get";
    formname.action = "http://www.baidu.com/baidu";
    document.search_form.word.value = document.search_form.word.value + " site:mjiayou.com";
    return true;
}
</SCRIPT>

<div class="search">
    <form name="search_form" target="_blank" onsubmit="search(this)">
        <input type="search" name="word" results="0" placeholder="百度站内搜索" onblur="this.value=''">
        <!-- <input type="submit" value="搜索"> -->
    </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
    <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/bower/">bower</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/css3/">css3</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reactjs/">reactjs</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/webpack/">webpack</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">1</span></li></ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
    <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/box/">box</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flex/">flex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/兼容性/">兼容性</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/冒泡/">冒泡</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/捕获/">捕获</a><span class="tag-list-count">1</span></li></ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/box/" style="font-size: 10px;">box</a> <a href="/tags/flex/" style="font-size: 10px;">flex</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/node/" style="font-size: 15px;">node</a> <a href="/tags/react/" style="font-size: 20px;">react</a> <a href="/tags/tools/" style="font-size: 15px;">tools</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/兼容性/" style="font-size: 10px;">兼容性</a> <a href="/tags/冒泡/" style="font-size: 10px;">冒泡</a> <a href="/tags/捕获/" style="font-size: 10px;">捕获</a>
  </div>
</div>


  <div class="widget tag">
<h3 class="title">微博</h3>
<ul class="entry">
<li><a href="" title="我的博客">我的微博</a></li>
<li><a href="" title="Hexo博客">Hexo博客</a></li>
</ul>
</div>

  <div class="widget tag">
<h3 class="title">友情链接</h3>
<ul class="entry">
<li><a href="http://yayahua.com/" title="yayahua">暂时开启</a></li>
<li><a href="http://www.zhufengpeixun.cn/" title="珠峰">珠峰学习</a></li>
</ul>
</div>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 jiangxunta
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

<script type="text/javascript">
var duoshuo_shortname = 'undefined';
var duoshuoQuery = {short_name:duoshuo_shortname};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = 'http://static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
</body>
</html>
